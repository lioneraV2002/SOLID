# SOLID
این مخزن حاوی محتویات پاسخ به تمرین دوم آزمایشگاه نرم‌افزار می‌باشد.
### توضیحات پروژه

این پروژه یک سرویس پیام‌رسانی است که در نسخه اولیه امکان ارسال پیام‌های SMS و ایمیل را با اعتبارسنجی شماره‌های تلفن و آدرس‌های ایمیل فراهم می‌کرد. در نسخه نهایی، قابلیت ارسال پیام‌های تلگرام اضافه شد که از شناسه‌های کاربری (شروع با @، حداقل ۵ کاراکتر) یا شماره‌های تلفن ۱۱ رقمی پشتیبانی می‌کند. این قابلیت جدید امکان دریافت و اعتبارسنجی شناسه‌های مبدا و مقصد را فراهم کرده و در صورت معتبر بودن، پیام را با بازخورد تلاش و موفقیت ارسال می‌کند. تغییرات شامل افزودن کلاس‌ها و متدهای جدید برای پشتیبانی از تلگرام، به‌روزرسانی رابط کاربری برای انتخاب گزینه تلگرام، و اصلاح اشکالات در سرویس ایمیل (مانند چاپ نادرست و اعلان‌های ورودی) است.

### جدول تغییرات (نسخه اولیه step-01-without-solid در مقابل نسخه نهایی آن)
<br>

| #  | نام کلاس                     | نام تغییر                     | توضیحات                                                                      | اندازه |
|----|-----------------------------|-------------------------------|------------------------------------------------------------------------------|--------|
| 1  | Main.java                   | افزودن گزینه تلگرام به منو     | افزودن گزینه ۳ برای پیام‌های تلگرام به منو.                                   | 1      |
| 2  | Main.java                   | افزودن کیس سوئیچ تلگرام       | افزودن کیس ۳ برای ایجاد `TelegramMessage`، تنظیم شناسه‌ها و محتوا.             | 1      |
| 3  | Main.java                   | به‌روزرسانی مدیریت سرویس       | افزودن منطق برای استفاده از `TelegramMessageService` برای `TelegramMessage`.   | 1      |
| 4  | MessageService.java         | افزودن متد تلگرام             | افزودن متد `sendTelegramMessage` به رابط برای پشتیبانی از تلگرام.             | 1      |
| 5  | TelegramMessage.java        | ایجاد کلاس جدید                | ایجاد `TelegramMessage` با `sourceId`، `targetId`، گترها و سترها.            | ۲      |
| 6  | SmsMessageService.java      | افزودن متد خالی تلگرام        | افزودن متد خالی `sendTelegramMessage` برای تطابق با رابط.                    | 1      |
| 7  | EmailMessageService.java    | افزودن متد خالی تلگرام        | افزودن متد خالی `sendTelegramMessage` برای تطابق با رابط.                    | 1      |
| 8  | EmailMessageService.java    | اصلاح بیانیه چاپ              | اصلاح چاپ `sendEmailMessage` به "Sending an Email" به جای "SMS".             | 1      |
| 9  | EmailMessageService.java    | به‌روزرسانی اعلان‌های ایمیل    | اصلاح اعلان‌های `Main` برای ایمیل به "source email" و "target email".         | 1      |
| 10 | TelegramMessageService.java | ایجاد کلاس جدید                | ایجاد برای مدیریت ارسال پیام تلگرام با اعتبارسنجی شناسه.                     | 2      |
| 11 | TelegramMessageService.java | متدهای خالی SMS/Email         | افزودن متدهای خالی `sendSmsMessage` و `sendEmailMessage` برای تطابق رابط.   | 1      |
| 12 | TelegramMessageService.java | اعتبارسنجی و ارسال تلگرام     | پیاده‌سازی `validateTelegramId` برای نام‌های کاربری (@، حداقل ۵ کاراکتر) یا شماره‌های ۱۱ رقمی و چاپ بازخورد تلاش/موفقیت. | 2      |

<br>


### جدول اصول رعایت شده و نشده SOLID در پروژه step-01-without-solid 
<br>

| اصل SOLID                     | رعایت شده در                              | نقض شده در                              |
|-------------------------------|------------------------------------------|-----------------------------------------|
| اصل مسئولیت واحد (SRP)         | SmsMessageService، EmailMessageService، TelegramMessageService: هر سرویس فقط به نوع پیام خود (SMS، ایمیل، تلگرام) رسیدگی می‌کند. | Main: ترکیب منطق رابط کاربری، ایجاد پیام و ارسال سرویس، مسئولیت‌های متعدد دارد. |
| اصل باز/بسته (OCP)            | MessageService: با افزودن متد sendTelegramMessage بدون تغییر پیاده‌سازی‌های موجود گسترش یافت. | Main: برای پشتیبانی از تلگرام مستقیماً اصلاح شد (گزینه منو، کیس سوئیچ، مدیریت سرویس). |
| اصل جایگزینی لیسکف (LSP)      | SmsMessageService، EmailMessageService، TelegramMessageService: همگی MessageService را به درستی پیاده‌سازی کرده و در Main قابل جایگزینی هستند. | هیچ‌کدام: نقض واضحی وجود ندارد.         |
| اصل تفکیک رابط (ISP)          | هیچ‌کدام: طراحی رابط از ISP پشتیبانی کامل نمی‌کند. | MessageService: سرویس‌ها را مجبور به پیاده‌سازی متدهای غیرمرتبط (مثل sendEmailMessage در SmsMessageService) می‌کند. |
| اصل وارونگی وابستگی (DIP)     | Main: به انتزاع MessageService وابسته است، نه پیاده‌سازی‌های خاص. | Main: مستقیماً سرویس‌های خاص (مثل new SmsMessageService()) را ایجاد می‌کند. |



<br>

### جدول راه حل‌های ارائه شده برای حل موارد رعایت نشده
Below is a table in Markdown format summarizing the SOLID principles that were violated in the previous code (focusing on services and `Main`), the reasons for those violations, and the solutions implemented in the latest code provided (aligned with `second_step.txt` and incorporating improvements like `UserInterface`, `MessageController`, and `ServiceRegistry`).

| اصل SOLID                     | دلیل نقض                                                                 | راه‌حل در کد جدید                                                                 |
|-------------------------------|-------------------------------------------------------------------------|-----------------------------------------------------------------------------------|
| **اصل مسئولیت واحد (SRP)**     | `Main` چندین مسئولیت (ورودی کاربر، ایجاد پیام، فراخوانی سرویس) را ترکیب می‌کرد. | `Main` به نقطه ورود ساده تبدیل شد. `UserInterface` برای مدیریت ورودی و رابط کاربری و `MessageController` برای ایجاد پیام و ارسال ایجاد شدند. |
| **اصل باز/بسته (OCP)**        | `Main` برای افزودن پشتیبانی تلگرام (گزینه منو، کیس سوئیچ) مستقیماً اصلاح شد. | `UserInterface` منطق ورودی را جدا کرد و `ServiceRegistry` امکان افزودن نوع پیام جدید بدون تغییر `MessageServiceFactory` یا `Main` را فراهم کرد. |
| **اصل تفکیک رابط (ISP)**       | `MessageService` سرویس‌ها را مجبور به پیاده‌سازی متدهای غیرمرتبط (مثل `sendEmailMessage` در `SmsMessageService`) می‌کرد. | رابط `MessageSender<T>` عمومی و رابط‌های خاص (`SmsService`، `EmailService`، `TelegramService`) معرفی شدند تا سرویس‌ها فقط متدهای مرتبط را پیاده‌سازی کنند. |
| **اصل وارونگی وابستگی (DIP)** | `MessageServiceFactory` مستقیماً سرویس‌های خاص (مثل `new SmsMessageService()`) را ایجاد می‌کرد. | `ServiceRegistry` برای ثبت نمونه‌های سرویس معرفی شد و `MessageServiceFactory` از آن برای دریافت سرویس‌ها استفاده می‌کند، وابستگی به پیاده‌سازی‌های خاص را حذف کرد. |

### توضیحات در مورد تغییرات اعمال شده
- **SRP**: جداسازی `UserInterface` و `MessageController` مسئولیت‌های رابط کاربری و منطق تجاری را تفکیک کرد و `Main` را ساده کرد.
- **OCP**: `ServiceRegistry` و طراحی مبتنی بر نوع پیام (`getMessageType`) امکان افزودن نوع پیام جدید بدون تغییر کد موجود را فراهم کرد.
- **ISP**: رابط‌های خاص برای هر نوع پیام جایگزین رابط کلی شدند، بنابراین سرویس‌ها فقط متدهای مرتبط را پیاده‌سازی می‌کنند.
- **DIP**: `ServiceRegistry` وابستگی‌های سرویس را مدیریت می‌کند و `MessageServiceFactory` به انتزاع وابسته است، نه پیاده‌سازی‌های خاص.

<br>

### پاسخ به سوالات

  1. **اگر اصول شی‌گرایی از ابتدا برقرار بود، چند مورد از تغییرات حذف می‌شد و چند تغییر لازم بود؟**
  - اگر اصول SOLID از ابتدا رعایت شده بود، تغییرات زیر از جدول تغییرات حذف می‌شدند، زیرا طراحی اولیه با اصول SOLID (مانند جداسازی مسئولیت‌ها، رابط‌های خاص، و تزریق وابستگی) نیاز به این اصلاحات را برطرف می‌کرد:
     - جداسازی رابط کاربری (نیاز به `UserInterface` نبود، زیرا `Main` فقط نقطه ورود می‌بود).
     - ایجاد کنترلر پیام (منطق کنترل از ابتدا جدا می‌بود).
     - جایگزینی با رابط‌های خاص (رابط‌های خاص از ابتدا استفاده می‌شدند).
     - افزودن متد خالی تلگرام به `SmsMessageService` (رابط‌های خاص مانع متدهای غیرمرتبط می‌شدند).
     - افزودن متد خالی تلگرام به `EmailMessageService` (همان دلیل).
     - اصلاح بیانیه چاپ (این اشکال از ابتدا وجود نمی‌داشت).
     - به‌روزرسانی اعلان‌های ایمیل (اعلان‌ها از ابتدا درست می‌بودند).
     - متدهای خالی SMS/Email در `TelegramMessageService` (رابط‌های خاص این نیاز را حذف می‌کردند).
     - افزودن رجیستری سرویس (تزریق وابستگی از ابتدا پیاده‌سازی می‌شد).
   - **تعداد تغییرات حذف‌شده**: ۹ تغییر
     <br>
     <br>
  - **تغییرات باقی‌مانده برای افزودن سرویس تلگرام**: برای افزودن سرویس تلگرام در یک طراحی SOLID، تنها تغییرات زیر لازم بود:
     - افزودن گزینه تلگرام به منو (برای رابط کاربری).
     - افزودن کیس سوئیچ تلگرام (برای ایجاد پیام تلگرام).
     - به‌روزرسانی مدیریت سرویس (برای استفاده از سرویس تلگرام).
     - افزودن متد تلگرام به رابط (برای گسترش رابط سرویس).
     - ایجاد کلاس `TelegramMessage` (برای مدل پیام تلگرام).
     - ایجاد کلاس `TelegramMessageService` (برای منطق سرویس تلگرام).
     - اعتبارسنجی و ارسال تلگرام (برای پیاده‌سازی اعتبارسنجی و ارسال).
     - افزودن نوع پیام به `Message` (برای پشتیبانی از نوع پیام).
     - افزودن نوع پیام به `SmsMessage` (برای سازگاری).
     - افزودن نوع پیام به `EmailMessage` (برای سازگاری).
     - افزودن نوع پیام به `TelegramMessage` (برای سازگاری).
     - ایجاد فکتوری (برای انتخاب سرویس).
  - **تعداد تغییرات لازم**: **۱۲ تغییر** در سطح کد برای افزودن سرویس تلگرام در یک طراحی اولیه SOLID.


2. **مزایای رعایت اصول شی‌گرایی**
  - رعایت اصول SOLID پروژه را ماژولار و قابل گسترش می‌کند، به طوری که افزودن سرویس‌های جدید (مثل تلگرام) با حداقل تغییرات انجام می‌شود.
  - جداسازی مسئولیت‌ها و تزریق وابستگی نگهداری و تست کد را آسان‌تر کرده و خطاها را کاهش می‌دهد.
